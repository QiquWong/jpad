clc; close all; clear all;

%% README
% THIS SCRIPT ALLOWS TO CREATE A .h5 DATABASE FOR A GIVEN ENGINE DECK 
% HAVING THE NET THRUST (lbf), THE STATIC THRUST (lbf) AND THE FUEL FLOW(lb/hr).
% IT RETURNS THE THRUST RATIO (T/T0) AND THE SFC IN (lb/lb*hr) 
% N.B.: DATA FOR A SINGLE ENGINE

%% IMPORT DATA
engineDataATR72_TAKE_OFF = importdata('ATR72_TAKE_OFF.mat');
engineDataATR72_CONTINOUS = importdata('ATR72_CONTINOUS.mat');
engineDataATR72_CLIMB = importdata('ATR72_CLIMB.mat');
engineDataATR72_CRUISE = importdata('ATR72_CRUISE.mat');
engineDataATR72_IDLE = importdata('ATR72_IDLE.mat');

nPoints = 50;
machVector = transpose(linspace(0, 0.6, nPoints));
t0 = 7770.5; % lbf
disp(strcat('Static thrust (lbf) = ', num2str(t0)));
t0 = t0*4.44822; % Newton
disp(strcat('Static thrust (N) = ', num2str(t0)));

%% MAX TAKE_OFF
%% h = 0ft
smoothingParameter = 0.999999;

thrustRatio_h0_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(1:13,2), ...
    (engineDataATR72_TAKE_OFF(1:13,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h0_TakeOff_Spline = ppval( ...
    thrustRatio_h0_TakeOff, ...
    machVector ...
    );

sfc_h0_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(1:13,2), ...
    engineDataATR72_TAKE_OFF(1:13,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h0_TakeOff_Spline = ppval( ...
    sfc_h0_TakeOff, ...
    machVector ...
    );
%% h = 5000ft
smoothingParameter = 0.999999;
thrustRatio_h5000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(14:26,2), ...
    (engineDataATR72_TAKE_OFF(14:26,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h5000_TakeOff_Spline = ppval( ...
    thrustRatio_h5000_TakeOff, ...
    machVector ...
    );

sfc_h5000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(14:26,2), ...
    engineDataATR72_TAKE_OFF(14:26,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h5000_TakeOff_Spline = ppval( ...
    sfc_h5000_TakeOff, ...
    machVector ...
    );

%% h = 10000ft
smoothingParameter = 0.999999;
thrustRatio_h10000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(27:39,2), ...
    (engineDataATR72_TAKE_OFF(27:39,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h10000_TakeOff_Spline = ppval( ...
    thrustRatio_h10000_TakeOff, ...
    machVector ...
    );

sfc_h10000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(27:39,2), ...
    engineDataATR72_TAKE_OFF(27:39,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h10000_TakeOff_Spline = ppval( ...
    sfc_h10000_TakeOff, ...
    machVector ...
    );

%% h = 15000ft
smoothingParameter = 0.999999;
thrustRatio_h15000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(40:52,2), ...
    (engineDataATR72_TAKE_OFF(40:52,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h15000_TakeOff_Spline = ppval( ...
    thrustRatio_h15000_TakeOff, ...
    machVector ...
    );

sfc_h15000_TakeOff = csaps( ...
    engineDataATR72_TAKE_OFF(40:52,2), ...
    engineDataATR72_TAKE_OFF(40:52,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h15000_TakeOff_Spline = ppval( ...
    sfc_h15000_TakeOff, ...
    machVector ...
    );

%% MAX CONTINOUS
%% h = 0ft
smoothingParameter = 0.999999;
thrustRatio_h0_Continous = csaps( ...
    engineDataATR72_CONTINOUS(1:13,2), ...
    (engineDataATR72_CONTINOUS(1:13,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h0_Continous_Spline = ppval( ...
    thrustRatio_h0_Continous, ...
    machVector ...
    );

sfc_h0_Continous = csaps( ...
    engineDataATR72_CONTINOUS(1:13,2), ...
    engineDataATR72_CONTINOUS(1:13,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h0_Continous_Spline = ppval( ...
    sfc_h0_Continous, ...
    machVector ...
    );

%% h = 5000ft
smoothingParameter = 0.999999;
thrustRatio_h5000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(14:26,2), ...
    (engineDataATR72_CONTINOUS(14:26,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h5000_Continous_Spline = ppval( ...
    thrustRatio_h5000_Continous, ...
    machVector ...
    );

sfc_h5000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(14:26,2), ...
    engineDataATR72_CONTINOUS(14:26,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h5000_Continous_Spline = ppval( ...
    sfc_h5000_Continous, ...
    machVector ...
    );

%% h = 10000ft
smoothingParameter = 0.999999;
thrustRatio_h10000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(27:39,2), ...
    (engineDataATR72_CONTINOUS(27:39,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h10000_Continous_Spline = ppval( ...
    thrustRatio_h10000_Continous, ...
    machVector ...
    );

sfc_h10000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(27:39,2), ...
    engineDataATR72_CONTINOUS(27:39,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h10000_Continous_Spline = ppval( ...
    sfc_h10000_Continous, ...
    machVector ...
    );

%% h = 15000ft
smoothingParameter = 0.999999;
thrustRatio_h15000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(40:52,2), ...
    (engineDataATR72_CONTINOUS(40:52,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h15000_Continous_Spline = ppval( ...
    thrustRatio_h15000_Continous, ...
    machVector ...
    );

sfc_h15000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(40:52,2), ...
    engineDataATR72_CONTINOUS(40:52,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h15000_Continous_Spline = ppval( ...
    sfc_h15000_Continous, ...
    machVector ...
    );

%% h = 20000ft
smoothingParameter = 0.999999;
thrustRatio_h20000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(53:65,2), ...
    (engineDataATR72_CONTINOUS(53:65,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h20000_Continous_Spline = ppval( ...
    thrustRatio_h20000_Continous, ...
    machVector ...
    );

sfc_h20000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(53:65,2), ...
    engineDataATR72_CONTINOUS(53:65,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h20000_Continous_Spline = ppval( ...
    sfc_h20000_Continous, ...
    machVector ...
    );

%% h = 25000ft
smoothingParameter = 0.999999;
thrustRatio_h25000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(66:78,2), ...
    (engineDataATR72_CONTINOUS(66:78,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h25000_Continous_Spline = ppval( ...
    thrustRatio_h25000_Continous, ...
    machVector ...
    );

sfc_h25000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(66:78,2), ...
    engineDataATR72_CONTINOUS(66:78,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h25000_Continous_Spline = ppval( ...
    sfc_h25000_Continous, ...
    machVector ...
    );

%% h = 30000ft
smoothingParameter = 0.999999;
thrustRatio_h30000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(79:91,2), ...
    (engineDataATR72_CONTINOUS(79:91,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h30000_Continous_Spline = ppval( ...
    thrustRatio_h30000_Continous, ...
    machVector ...
    );

sfc_h30000_Continous = csaps( ...
    engineDataATR72_CONTINOUS(79:91,2), ...
    engineDataATR72_CONTINOUS(79:91,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h30000_Continous_Spline = ppval( ...
    sfc_h30000_Continous, ...
    machVector ...
    );

%% MAX CLIMB
%% h = 0ft
smoothingParameter = 0.999999;
thrustRatio_h0_Climb = csaps( ...
    engineDataATR72_CLIMB(1:13,2), ...
    (engineDataATR72_CLIMB(1:13,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h0_Climb_Spline = ppval( ...
    thrustRatio_h0_Climb, ...
    machVector ...
    );

sfc_h0_Climb = csaps( ...
    engineDataATR72_CLIMB(1:13,2), ...
    engineDataATR72_CLIMB(1:13,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h0_Climb_Spline = ppval( ...
    sfc_h0_Climb, ...
    machVector ...
    );

%% h = 5000ft
smoothingParameter = 0.999999;
thrustRatio_h5000_Climb = csaps( ...
    engineDataATR72_CLIMB(14:26,2), ...
    (engineDataATR72_CLIMB(14:26,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h5000_Climb_Spline = ppval( ...
    thrustRatio_h5000_Climb, ...
    machVector ...
    );

sfc_h5000_Climb = csaps( ...
    engineDataATR72_CLIMB(14:26,2), ...
    engineDataATR72_CLIMB(14:26,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h5000_Climb_Spline = ppval( ...
    sfc_h5000_Climb, ...
    machVector ...
    );

%% h = 10000ft
smoothingParameter = 0.999999;
thrustRatio_h10000_Climb = csaps( ...
    engineDataATR72_CLIMB(27:39,2), ...
    (engineDataATR72_CLIMB(27:39,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h10000_Climb_Spline = ppval( ...
    thrustRatio_h10000_Climb, ...
    machVector ...
    );

sfc_h10000_Climb = csaps( ...
    engineDataATR72_CLIMB(27:39,2), ...
    engineDataATR72_CLIMB(27:39,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h10000_Climb_Spline = ppval( ...
    sfc_h10000_Climb, ...
    machVector ...
    );

%% h = 15000ft
smoothingParameter = 0.999999;
thrustRatio_h15000_Climb = csaps( ...
    engineDataATR72_CLIMB(40:52,2), ...
    (engineDataATR72_CLIMB(40:52,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h15000_Climb_Spline = ppval( ...
    thrustRatio_h15000_Climb, ...
    machVector ...
    );

sfc_h15000_Climb = csaps( ...
    engineDataATR72_CLIMB(40:52,2), ...
    engineDataATR72_CLIMB(40:52,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h15000_Climb_Spline = ppval( ...
    sfc_h15000_Climb, ...
    machVector ...
    );

%% h = 20000ft
smoothingParameter = 0.999999;
thrustRatio_h20000_Climb = csaps( ...
    engineDataATR72_CLIMB(53:65,2), ...
    (engineDataATR72_CLIMB(53:65,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h20000_Climb_Spline = ppval( ...
    thrustRatio_h20000_Climb, ...
    machVector ...
    );

sfc_h20000_Climb = csaps( ...
    engineDataATR72_CLIMB(53:65,2), ...
    engineDataATR72_CLIMB(53:65,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h20000_Climb_Spline = ppval( ...
    sfc_h20000_Climb, ...
    machVector ...
    );

%% h = 25000ft
smoothingParameter = 0.999999;
thrustRatio_h25000_Climb = csaps( ...
    engineDataATR72_CLIMB(66:78,2), ...
    (engineDataATR72_CLIMB(66:78,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h25000_Climb_Spline = ppval( ...
    thrustRatio_h25000_Climb, ...
    machVector ...
    );

sfc_h25000_Climb = csaps( ...
    engineDataATR72_CLIMB(66:78,2), ...
    engineDataATR72_CLIMB(66:78,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h25000_Climb_Spline = ppval( ...
    sfc_h25000_Climb, ...
    machVector ...
    );

%% h = 30000ft
smoothingParameter = 0.999999;
thrustRatio_h30000_Climb = csaps( ...
    engineDataATR72_CLIMB(79:91,2), ...
    (engineDataATR72_CLIMB(79:91,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h30000_Climb_Spline = ppval( ...
    thrustRatio_h30000_Climb, ...
    machVector ...
    );

sfc_h30000_Climb = csaps( ...
    engineDataATR72_CLIMB(79:91,2), ...
    engineDataATR72_CLIMB(79:91,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h30000_Climb_Spline = ppval( ...
    sfc_h30000_Climb, ...
    machVector ...
    );

%% MAX IDLE
%% h = 0ft
smoothingParameter = 0.999999;
thrustRatio_h0_Idle = csaps( ...
    engineDataATR72_IDLE(1:13,2), ...
    (engineDataATR72_IDLE(1:13,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h0_Idle_Spline = ppval( ...
    thrustRatio_h0_Idle, ...
    machVector ...
    );

sfc_h0_Idle = csaps( ...
    engineDataATR72_IDLE(1:13,2), ...
    engineDataATR72_IDLE(1:13,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h0_Idle_Spline = ppval( ...
    sfc_h0_Idle, ...
    machVector ...
    );

%% h = 5000ft
smoothingParameter = 0.999999;
thrustRatio_h5000_Idle = csaps( ...
    engineDataATR72_IDLE(14:26,2), ...
    (engineDataATR72_IDLE(14:26,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h5000_Idle_Spline = ppval( ...
    thrustRatio_h5000_Idle, ...
    machVector ...
    );

sfc_h5000_Idle = csaps( ...
    engineDataATR72_IDLE(14:26,2), ...
    engineDataATR72_IDLE(14:26,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h5000_Idle_Spline = ppval( ...
    sfc_h5000_Idle, ...
    machVector ...
    );

%% h = 10000ft
smoothingParameter = 0.999999;
thrustRatio_h10000_Idle = csaps( ...
    engineDataATR72_IDLE(27:39,2), ...
    (engineDataATR72_IDLE(27:39,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h10000_Idle_Spline = ppval( ...
    thrustRatio_h10000_Idle, ...
    machVector ...
    );

sfc_h10000_Idle = csaps( ...
    engineDataATR72_IDLE(27:39,2), ...
    engineDataATR72_IDLE(27:39,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h10000_Idle_Spline = ppval( ...
    sfc_h10000_Idle, ...
    machVector ...
    );

%% h = 15000ft
smoothingParameter = 0.999999;
thrustRatio_h15000_Idle = csaps( ...
    engineDataATR72_IDLE(40:52,2), ...
    (engineDataATR72_IDLE(40:52,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h15000_Idle_Spline = ppval( ...
    thrustRatio_h15000_Idle, ...
    machVector ...
    );

sfc_h15000_Idle = csaps( ...
    engineDataATR72_IDLE(40:52,2), ...
    engineDataATR72_IDLE(40:52,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h15000_Idle_Spline = ppval( ...
    sfc_h15000_Idle, ...
    machVector ...
    );

%% h = 20000ft
smoothingParameter = 0.999999;
thrustRatio_h20000_Idle = csaps( ...
    engineDataATR72_IDLE(53:65,2), ...
    (engineDataATR72_IDLE(53:65,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h20000_Idle_Spline = ppval( ...
    thrustRatio_h20000_Idle, ...
    machVector ...
    );

sfc_h20000_Idle = csaps( ...
    engineDataATR72_IDLE(53:65,2), ...
    engineDataATR72_IDLE(53:65,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h20000_Idle_Spline = ppval( ...
    sfc_h20000_Idle, ...
    machVector ...
    );

%% h = 25000ft
smoothingParameter = 0.999999;
thrustRatio_h25000_Idle = csaps( ...
    engineDataATR72_IDLE(66:78,2), ...
    (engineDataATR72_IDLE(66:78,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h25000_Idle_Spline = ppval( ...
    thrustRatio_h25000_Idle, ...
    machVector ...
    );

sfc_h25000_Idle = csaps( ...
    engineDataATR72_IDLE(66:78,2), ...
    engineDataATR72_IDLE(66:78,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h25000_Idle_Spline = ppval( ...
    sfc_h25000_Idle, ...
    machVector ...
    );

%% h = 30000ft
smoothingParameter = 0.999999;
thrustRatio_h30000_Idle = csaps( ...
    engineDataATR72_IDLE(79:91,2), ...
    (engineDataATR72_IDLE(79:91,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h30000_Idle_Spline = ppval( ...
    thrustRatio_h30000_Idle, ...
    machVector ...
    );

sfc_h30000_Idle = csaps( ...
    engineDataATR72_IDLE(79:91,2), ...
    engineDataATR72_IDLE(79:91,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h30000_Idle_Spline = ppval( ...
    sfc_h30000_Idle, ...
    machVector ...
    );

%% MAX CRUISE
%% h = 0ft
smoothingParameter = 0.999999;
thrustRatio_h0_Cruise = csaps( ...
    engineDataATR72_CRUISE(1:13,2), ...
    (engineDataATR72_CRUISE(1:13,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h0_Cruise_Spline = ppval( ...
    thrustRatio_h0_Cruise, ...
    machVector ...
    );

sfc_h0_Cruise = csaps( ...
    engineDataATR72_CRUISE(1:13,2), ...
    engineDataATR72_CRUISE(1:13,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h0_Cruise_Spline = ppval( ...
    sfc_h0_Cruise, ...
    machVector ...
    );

%% h = 5000ft
smoothingParameter = 0.999999;
thrustRatio_h5000_Cruise = csaps( ...
    engineDataATR72_CRUISE(14:26,2), ...
    (engineDataATR72_CRUISE(14:26,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h5000_Cruise_Spline = ppval( ...
    thrustRatio_h5000_Cruise, ...
    machVector ...
    );

sfc_h5000_Cruise = csaps( ...
    engineDataATR72_CRUISE(14:26,2), ...
    engineDataATR72_CRUISE(14:26,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h5000_Cruise_Spline = ppval( ...
    sfc_h5000_Cruise, ...
    machVector ...
    );

%% h = 10000ft
smoothingParameter = 0.999999;
thrustRatio_h10000_Cruise = csaps( ...
    engineDataATR72_CRUISE(27:39,2), ...
    (engineDataATR72_CRUISE(27:39,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h10000_Cruise_Spline = ppval( ...
    thrustRatio_h10000_Cruise, ...
    machVector ...
    );

sfc_h10000_Cruise = csaps( ...
    engineDataATR72_CRUISE(27:39,2), ...
    engineDataATR72_CRUISE(27:39,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h10000_Cruise_Spline = ppval( ...
    sfc_h10000_Cruise, ...
    machVector ...
    );

%% h = 15000ft
smoothingParameter = 0.999999;
thrustRatio_h15000_Cruise = csaps( ...
    engineDataATR72_CRUISE(40:52,2), ...
    (engineDataATR72_CRUISE(40:52,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h15000_Cruise_Spline = ppval( ...
    thrustRatio_h15000_Cruise, ...
    machVector ...
    );

sfc_h15000_Cruise = csaps( ...
    engineDataATR72_CRUISE(40:52,2), ...
    engineDataATR72_CRUISE(40:52,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h15000_Cruise_Spline = ppval( ...
    sfc_h15000_Cruise, ...
    machVector ...
    );

%% h = 20000ft
smoothingParameter = 0.999999;
thrustRatio_h20000_Cruise = csaps( ...
    engineDataATR72_CRUISE(53:65,2), ...
    (engineDataATR72_CRUISE(53:65,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h20000_Cruise_Spline = ppval( ...
    thrustRatio_h20000_Cruise, ...
    machVector ...
    );

sfc_h20000_Cruise = csaps( ...
    engineDataATR72_CRUISE(53:65,2), ...
    engineDataATR72_CRUISE(53:65,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h20000_Cruise_Spline = ppval( ...
    sfc_h20000_Cruise, ...
    machVector ...
    );

%% h = 25000ft
smoothingParameter = 0.999999;
thrustRatio_h25000_Cruise = csaps( ...
    engineDataATR72_CRUISE(66:78,2), ...
    (engineDataATR72_CRUISE(66:78,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h25000_Cruise_Spline = ppval( ...
    thrustRatio_h25000_Cruise, ...
    machVector ...
    );

sfc_h25000_Cruise = csaps( ...
    engineDataATR72_CRUISE(66:78,2), ...
    engineDataATR72_CRUISE(66:78,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h25000_Cruise_Spline = ppval( ...
    sfc_h25000_Cruise, ...
    machVector ...
    );

%% h = 30000ft
smoothingParameter = 0.999999;
thrustRatio_h30000_Cruise = csaps( ...
    engineDataATR72_CRUISE(79:91,2), ...
    (engineDataATR72_CRUISE(79:91,4).*4.44822271072093)./t0, ...
    smoothingParameter ...
    );

thrustRatio_h30000_Cruise_Spline = ppval( ...
    thrustRatio_h30000_Cruise, ...
    machVector ...
    );

sfc_h30000_Cruise = csaps( ...
    engineDataATR72_CRUISE(79:91,2), ...
    engineDataATR72_CRUISE(79:91,3)./t0.*9.81./2.20462, ...
    smoothingParameter ...
    );

sfc_h30000_Cruise_Spline = ppval( ...
    sfc_h30000_Cruise, ...
    machVector ...
    );

%% PLOTS
%% MAX TAKE OFF THRUST RATIO
figure(1)
plot ( ...
    machVector, thrustRatio_h0_TakeOff_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, thrustRatio_h5000_TakeOff_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h10000_TakeOff_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, thrustRatio_h15000_TakeOff_Spline, 'b-.' ... 
 );

xlabel('Mach'); ylabel('T/T0');
title('Thrust ratio PW2750 - MAX TAKE-OFF');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft');
axis([0 0.6 0 1]);
grid on;

%% MAX CONTINOUS THRUST RATIO
figure(2)
plot ( ...
    machVector, thrustRatio_h0_Continous_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, thrustRatio_h5000_Continous_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h10000_Continous_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, thrustRatio_h15000_Continous_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h20000_Continous_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h25000_Continous_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h30000_Continous_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('T/T0');
title('Thrust ratio PW2750 - MAX CONTINOUS');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
axis([0 0.6 0 1]);
grid on;

%% MAX CLIMB THRUST RATIO
figure(3)
plot ( ...
    machVector, thrustRatio_h0_Climb_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, thrustRatio_h5000_Climb_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h10000_Climb_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, thrustRatio_h15000_Climb_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h20000_Climb_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h25000_Climb_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h30000_Climb_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('T/T0');
title('Thrust ratio PW2750 - MAX CLIMB');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
axis([0 0.6 0 1]);
grid on;

%% MAX CRUISE THRUST RATIO
figure(4)
plot ( ...
    machVector, thrustRatio_h0_Cruise_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, thrustRatio_h5000_Cruise_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h10000_Cruise_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, thrustRatio_h15000_Cruise_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h20000_Cruise_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h25000_Cruise_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h30000_Cruise_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('T/T0');
title('Thrust ratio PW2750 - MAX CRUISE');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
axis([0 0.6 0 1]);
grid on;

%% MAX IDLE THRUST RATIO
figure(5)
plot ( ...
    machVector, thrustRatio_h0_Idle_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, thrustRatio_h5000_Idle_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h10000_Idle_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, thrustRatio_h15000_Idle_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h20000_Idle_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h25000_Idle_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, thrustRatio_h30000_Idle_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('T/T0');
title('Thrust ratio PW2750 - MAX IDLE');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
axis([0 0.6 -0.2 1]);
grid on;

%% MAX TAKE OFF SFC
figure(6)
plot ( ...
    machVector, sfc_h0_TakeOff_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, sfc_h5000_TakeOff_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, sfc_h10000_TakeOff_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, sfc_h15000_TakeOff_Spline, 'b-.' ... 
 );

xlabel('Mach'); ylabel('SFC (lb/(lb*hr))');
title('SFC PW2750 - MAX TAKE-OFF');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft');
% axis([0 0.6 -0.2 1]);
grid on;

%% MAX CONTINOUS SFC
figure(7)
plot ( ...
    machVector, sfc_h0_Continous_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, sfc_h5000_Continous_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, sfc_h10000_Continous_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, sfc_h15000_Continous_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, sfc_h20000_Continous_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, sfc_h25000_Continous_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, sfc_h30000_Continous_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('SFC (lb/(lb*hr))');
title('SFC PW2750 - MAX CONTINOUS');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
% axis([0 0.6 -0.2 1]);
grid on;

%% MAX CLIMB SFC
figure(8)
plot ( ...
    machVector, sfc_h0_Climb_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, sfc_h5000_Climb_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, sfc_h10000_Climb_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, sfc_h15000_Climb_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, sfc_h20000_Climb_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, sfc_h25000_Climb_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, sfc_h30000_Climb_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('SFC (lb/(lb*hr))');
title('SFC PW2750 - MAX CLIMB');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
% axis([0 0.6 -0.2 1]);
grid on;

%% MAX CRUISE SFC
figure(9)
plot ( ...
    machVector, sfc_h0_Cruise_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, sfc_h5000_Cruise_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, sfc_h10000_Cruise_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, sfc_h15000_Cruise_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, sfc_h20000_Cruise_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, sfc_h25000_Cruise_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, sfc_h30000_Cruise_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('SFC (lb/(lb*hr))');
title('SFC PW2750 - MAX CRUISE');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
% axis([0 0.6 -0.2 1]);
grid on;

%% MAX IDLE SFC
figure(10)
plot ( ...
    machVector, sfc_h0_Idle_Spline, 'b-+' ... 
 );
 hold on
 
 plot ( ...
    machVector, sfc_h5000_Idle_Spline, 'b-o' ... 
 );

hold on

plot ( ...
    machVector, sfc_h10000_Idle_Spline, 'b-*' ...
 );

hold on

plot ( ...
    machVector, sfc_h15000_Idle_Spline, 'b-.' ... 
 );

hold on

plot ( ...
    machVector, sfc_h20000_Idle_Spline, 'b-x' ... 
 );

hold on

plot ( ...
    machVector, sfc_h25000_Idle_Spline, 'b-^' ... 
 );

hold on

plot ( ...
    machVector, sfc_h30000_Idle_Spline, 'b-v' ... 
 );

xlabel('Mach'); ylabel('SFC (lb/(lb*hr))');
title('SFC PW2750 - MAX IDLE');
legend('h = 0ft', 'h = 5000ft', 'h = 10000ft', 'h = 15000ft', ...
       'h = 20000ft', 'h = 25000ft', 'h = 30000ft');
% axis([0 0.6 -0.2 1]);
grid on;

%% PREPARING OUTPUT HDF
%% MAX TAKE-OFF THRUST
altitudesVector = [ ...
    0;5000;10000;15000 ...
    ];

%columns --> curves
myData = [ ...
        thrustRatio_h0_TakeOff_Spline,...
        thrustRatio_h5000_TakeOff_Spline, ... 
        thrustRatio_h10000_TakeOff_Spline, ... 
        thrustRatio_h15000_TakeOff_Spline, ...
        ];    
hdfFileName = 'TakeOffThrust.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/TakeOffThrust/data', size(myData'));
h5write(hdfFileName, '/TakeOffThrust/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/TakeOffThrust/var_0', size(altitudesVector'));
h5write(hdfFileName, '/TakeOffThrust/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/TakeOffThrust/var_1', size(machVector'));
h5write(hdfFileName, '/TakeOffThrust/var_1', machVector');

%% MAX TAKE-OFF SFC
altitudesVector = [ ...
    0;5000;10000;15000 ...
    ];

%columns --> curves
myData = [ ...
        sfc_h0_TakeOff_Spline,...
        sfc_h5000_TakeOff_Spline, ... 
        sfc_h10000_TakeOff_Spline, ... 
        sfc_h15000_TakeOff_Spline, ...
        ];    
hdfFileName = 'TakeOffSFC.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/TakeOffSFC/data', size(myData'));
h5write(hdfFileName, '/TakeOffSFC/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/TakeOffSFC/var_0', size(altitudesVector'));
h5write(hdfFileName, '/TakeOffSFC/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/TakeOffSFC/var_1', size(machVector'));
h5write(hdfFileName, '/TakeOffSFC/var_1', machVector');

%% MAX CONTINOUS THRUST
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        thrustRatio_h0_Continous_Spline, ...
        thrustRatio_h5000_Continous_Spline, ... 
        thrustRatio_h10000_Continous_Spline, ... 
        thrustRatio_h15000_Continous_Spline, ...
        thrustRatio_h20000_Continous_Spline, ...
        thrustRatio_h25000_Continous_Spline, ...
        thrustRatio_h30000_Continous_Spline
        ];    
hdfFileName = 'MaximumContinuousThrust.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumContinuousThrust/data', size(myData'));
h5write(hdfFileName, '/MaximumContinuousThrust/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumContinuousThrust/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumContinuousThrust/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumContinuousThrust/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumContinuousThrust/var_1', machVector');

%% MAX CONTINOUS SFC
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        sfc_h0_Continous_Spline, ...
        sfc_h5000_Continous_Spline, ... 
        sfc_h10000_Continous_Spline, ... 
        sfc_h15000_Continous_Spline, ...
        sfc_h20000_Continous_Spline, ...
        sfc_h25000_Continous_Spline, ...
        sfc_h30000_Continous_Spline
        ];    
hdfFileName = 'MaximumContinuousSFC.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumContinuousSFC/data', size(myData'));
h5write(hdfFileName, '/MaximumContinuousSFC/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumContinuousSFC/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumContinuousSFC/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumContinuousSFC/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumContinuousSFC/var_1', machVector');

%% MAX CLIMB THRUST
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        thrustRatio_h0_Climb_Spline, ...
        thrustRatio_h5000_Climb_Spline, ... 
        thrustRatio_h10000_Climb_Spline, ... 
        thrustRatio_h15000_Climb_Spline, ...
        thrustRatio_h20000_Climb_Spline, ...
        thrustRatio_h25000_Climb_Spline, ...
        thrustRatio_h30000_Climb_Spline
        ];    
hdfFileName = 'MaximumClimbThrust.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumClimbThrust/data', size(myData'));
h5write(hdfFileName, '/MaximumClimbThrust/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumClimbThrust/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumClimbThrust/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumClimbThrust/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumClimbThrust/var_1', machVector');

%% MAX CLIMB SFC
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        sfc_h0_Climb_Spline, ...
        sfc_h5000_Climb_Spline, ... 
        sfc_h10000_Climb_Spline, ... 
        sfc_h15000_Climb_Spline, ...
        sfc_h20000_Climb_Spline, ...
        sfc_h25000_Climb_Spline, ...
        sfc_h30000_Climb_Spline
        ];    
hdfFileName = 'MaximumClimbSFC.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumClimbSFC/data', size(myData'));
h5write(hdfFileName, '/MaximumClimbSFC/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumClimbSFC/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumClimbSFC/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumClimbSFC/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumClimbSFC/var_1', machVector');

%% MAX CRUISE THRUST
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        thrustRatio_h0_Cruise_Spline, ...
        thrustRatio_h5000_Cruise_Spline, ... 
        thrustRatio_h10000_Cruise_Spline, ... 
        thrustRatio_h15000_Cruise_Spline, ...
        thrustRatio_h20000_Cruise_Spline, ...
        thrustRatio_h25000_Cruise_Spline, ...
        thrustRatio_h30000_Cruise_Spline
        ];    
hdfFileName = 'MaximumCruiseThrust.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumCruiseThrust/data', size(myData'));
h5write(hdfFileName, '/MaximumCruiseThrust/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumCruiseThrust/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumCruiseThrust/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumCruiseThrust/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumCruiseThrust/var_1', machVector');

%% MAX CRUISE SFC
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        sfc_h0_Cruise_Spline, ...
        sfc_h5000_Cruise_Spline, ... 
        sfc_h10000_Cruise_Spline, ... 
        sfc_h15000_Cruise_Spline, ...
        sfc_h20000_Cruise_Spline, ...
        sfc_h25000_Cruise_Spline, ...
        sfc_h30000_Cruise_Spline
        ];    
hdfFileName = 'MaximumCruiseSFC.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/MaximumCruiseSFC/data', size(myData'));
h5write(hdfFileName, '/MaximumCruiseSFC/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/MaximumCruiseSFC/var_0', size(altitudesVector'));
h5write(hdfFileName, '/MaximumCruiseSFC/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/MaximumCruiseSFC/var_1', size(machVector'));
h5write(hdfFileName, '/MaximumCruiseSFC/var_1', machVector');

%% MAX IDLE THRUST
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        thrustRatio_h0_Idle_Spline, ...
        thrustRatio_h5000_Idle_Spline, ... 
        thrustRatio_h10000_Idle_Spline, ... 
        thrustRatio_h15000_Idle_Spline, ...
        thrustRatio_h20000_Idle_Spline, ...
        thrustRatio_h25000_Idle_Spline, ...
        thrustRatio_h30000_Idle_Spline
        ];    
hdfFileName = 'IdleThrust.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/IdleThrust/data', size(myData'));
h5write(hdfFileName, '/IdleThrust/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/IdleThrust/var_0', size(altitudesVector'));
h5write(hdfFileName, '/IdleThrust/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/IdleThrust/var_1', size(machVector'));
h5write(hdfFileName, '/IdleThrust/var_1', machVector');

%% MAX IDLE SFC
altitudesVector = [ ...
    0;5000;10000;15000;20000;25000;30000 ...
    ];

%columns --> curves
myData = [ ...
        sfc_h0_Idle_Spline, ...
        sfc_h5000_Idle_Spline, ... 
        sfc_h10000_Idle_Spline, ... 
        sfc_h15000_Idle_Spline, ...
        sfc_h20000_Idle_Spline, ...
        sfc_h25000_Idle_Spline, ...
        sfc_h30000_Idle_Spline
        ];    
hdfFileName = 'IdleSFC.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

% Dataset: data
h5create(hdfFileName, '/IdleSFC/data', size(myData'));
h5write(hdfFileName, '/IdleSFC/data', myData');

% Dataset: var_0
h5create(hdfFileName, '/IdleSFC/var_0', size(altitudesVector'));
h5write(hdfFileName, '/IdleSFC/var_0', altitudesVector');

% Dataset: var_1
h5create(hdfFileName, '/IdleSFC/var_1', size(machVector'));
h5write(hdfFileName, '/IdleSFC/var_1', machVector');
