clear all, close all, clc

%% load data file generated by Grabit
% https://it.mathworks.com/matlabcentral/fileexchange/7173-grabit

fileBaseNames = {'Data001'};
nPoints = 29;

xx = linspace(0, 1, nPoints);
    
    fileName = sprintf('%s.mat',fileBaseNames{1});
    s = load(fileName, '-mat');

    % Allocate imported array to column variable names
    
    x = s.(fileBaseNames{1})(:, 1);
    %x = flipud(x);
    x(end) = 1;
    x(1)=0;
    
    y = s.(fileBaseNames{1})(:, 2);
    %y = flipud(y);
    y(end) = 1;
    y(1)=0;
    
    %% Smoothing
    pp = csaps(x, y, 0.999999);
    c = ppval(pp(1), xx');
    data(:,1) = c;

    plot (xx', data(:,1), '-*');
   
ylabel('$ \frac{b''_f}{b''_W}$','interpreter','latex'); 
xlabel('$\frac{b_f}{b}$','interpreter','latex');
set(get(gca,'ylabel'),'rotation',0)

title('Effective flap span in the presence of the ground');
axis([0 1 0 1]);


%% preparing output to HDF


b_f_frac_b = xx';

 
%columns --> curves
 
hdfFileName = 'Delta_epsilon_G_b_apex_f_frac_b_apex_w_vs_b_f_frac_b.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

h5create(hdfFileName, '/(Delta_epsilon_G)_b_apex_f_frac_b_apex_w_vs_b_f_frac_b/data', size(data'));
h5write(hdfFileName, '/(Delta_epsilon_G)_b_apex_f_frac_b_apex_w_vs_b_f_frac_b/data', data');

h5create(hdfFileName, '/(Delta_epsilon_G)_b_apex_f_frac_b_apex_w_vs_b_f_frac_b/var_0', size(b_f_frac_b'));
h5write(hdfFileName, '/(Delta_epsilon_G)_b_apex_f_frac_b_apex_w_vs_b_f_frac_b/var_0', b_f_frac_b');





