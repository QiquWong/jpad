clear all, close all, clc

%% load data file generated by Grabit
% https://it.mathworks.com/matlabcentral/fileexchange/7173-grabit

fileBaseNames = {'sigma_vs_2hfracb'};
nPoints = 41;

xx = linspace(0.0, 2, nPoints);
    
    fileName = sprintf('%s.mat',fileBaseNames{1});
    s = load(fileName, '-mat');

    % Allocate imported array to column variable names
    
    x = s.(fileBaseNames{1})(:, 1);
    x(end) = 2;
    
    y = s.(fileBaseNames{1})(:, 2);
    
    %% Smoothing
    pp = csaps(x, y, 0.999999);
    c = ppval(pp(1), xx');
    data(:,1) = c;

    plot (xx', data(:,1), '-*');
   
xlabel('$\frac{h}{b/2}$','interpreter','latex'); 
ylabel('\sigma');
set(get(gca,'ylabel'),'rotation',0)

title('Prandtl''s interference coefficient - indicative of variation in induced vertical velocity with ground height');
axis([0 2 0 .7]);


%% preparing output to HDF


hb_2 = xx';

 
%columns --> curves
 
hdfFileName = 'Delta_alpha_G_sigma_vs_2hfracb.h5';

if ( exist(hdfFileName, 'file') )
    fprintf('file %s exists, deleting and creating a new one\n', hdfFileName);
    delete(hdfFileName)
else
    fprintf('Creating new file %s\n', hdfFileName);
end

h5create(hdfFileName, '/(Delta_alpha_G)_sigma_vs_2hfracb/data', size(data'));
h5write(hdfFileName, '/(Delta_alpha_G)_sigma_vs_2hfracb/data', data');

h5create(hdfFileName, '/(Delta_alpha_G)_sigma_vs_2hfracb/var_0', size(hb_2'));
h5write(hdfFileName, '/(Delta_alpha_G)_sigma_vs_2hfracb/var_0', hb_2');





