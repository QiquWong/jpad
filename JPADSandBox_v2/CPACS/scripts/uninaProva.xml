<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="http://jsbsim.sourceforge.net/JSBSimScript.xsl"?>
<runscript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://jsbsim.sf.net/JSBSimScript.xsd"
    name="C172 cruise at 4K, 100% power">
  <description>This run is for testing the C172 altitude hold autopilot and cruise performance</description>
  <use aircraft="D150_JSBSim" initialize="initialCondition"/>

  <run start="0.0" end="50" dt="0.0083333">
  
    <property value="0"> simulation/run_id </property>

    <event name="Set Temperature">
      <condition>
        simulation/sim-time-sec  ge  0.0
      </condition>
      <set name="atmosphere/delta-T">
        <function>
          <switch>
            <p> simulation/run_id </p>
            <v>   0.0 </v>
            <v> -36.0 </v>
            <v>  36.0 </v>
          </switch>
        </function>
      </set>
    </event>
    
    <event name="Start engine">
      <condition>
        simulation/sim-time-sec  ge  0.01
      </condition>
      <set name="fcs/throttle-cmd-norm" action="FG_RAMP" value="0.50" tc="0.05"/>
  	  <set name="fcs/flap-pos-norm" value="1.0"/>
	  <set name="fcs/elevator-pos-norm" value="0.0"/>
	  <set name="fcs/rudder-pos-norm" value="0.0"/>

      <notify/>
    </event> 

    <event name="Trim">
      <condition>
        simulation/sim-time-sec  gt  1.0
      </condition>
      <set name="simulation/do_simple_trim" value="1"/>
      <notify>
        <property> velocities/u-aero-fps </property>
        <property> velocities/v-aero-fps </property>
        <property> velocities/w-aero-fps </property>
        <property> fcs/elevator-cmd-norm </property>
        <property> fcs/aileron-cmd-norm </property>
        <property> fcs/rudder-cmd-norm </property>
        <property> fcs/elevator-pos-norm </property>
        <property> fcs/rudder-pos-norm </property>
		<property> fcs/flap-pos-norm </property>
      </notify>
    </event>


    <event name="Introduce gust">
      <condition> simulation/sim-time-sec ge 10 </condition>
      <set name="atmosphere/cosine-gust/startup-duration-sec" value="5"/>
      <set name="atmosphere/cosine-gust/steady-duration-sec" value="1"/>
      <set name="atmosphere/cosine-gust/end-duration-sec" value="5"/>
      <set name="atmosphere/cosine-gust/magnitude-ft_sec" value="30"/>
      <set name="atmosphere/cosine-gust/frame" value="2"/>
      <set name="atmosphere/cosine-gust/X-velocity-ft_sec" value="-1"/>
      <set name="atmosphere/cosine-gust/Y-velocity-ft_sec" value="0"/>
      <set name="atmosphere/cosine-gust/Z-velocity-ft_sec" value="0"/>
      <set name="atmosphere/cosine-gust/start" value="1"/>
      <notify/>
    </event>

  </run>
</runscript>